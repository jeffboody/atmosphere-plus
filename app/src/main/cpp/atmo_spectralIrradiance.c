/*
 * BSD 3-Clause License
 *
 * Copyright (c) 2025, Jeff Boody
 * Copyright (c) 2019, Daniel Shervheim
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 *    list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 *
 * 3. Neither the name of the copyright holder nor the names of its
 *    contributors may be used to endorse or promote products derived from
 *    this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#include "atmo_spectralIrradiance.h"

// Solar irradiance values (W / (m^2 * nm)).
// Values range from:       0.000000280m (280 nm)
// To:                      0.000001000m (1000 nm)
// in increments of:        0.000000001m (1nm)
// https://rredc.nrel.gov/solar//spectra/am1.5/ASTMG173/ASTMG173.html
// https://github.com/danielshervheim/atmosphere
static const double kSpectralIrradianceTable[721] =
{
	8.2000E-02,
	1.5000E-01,
	2.6700E-01,
	3.2500E-01,
	2.9900E-01,
	1.7589E-01,
	2.4200E-01,
	3.6200E-01,
	3.1100E-01,
	3.9200E-01,
	5.6300E-01,
	6.1800E-01,
	5.6700E-01,
	5.3800E-01,
	5.3300E-01,
	5.2700E-01,
	5.7300E-01,
	4.7800E-01,
	5.2800E-01,
	4.7200E-01,
	4.5794E-01,
	4.6300E-01,
	4.4900E-01,
	6.1200E-01,
	6.2100E-01,
	6.4200E-01,
	5.6500E-01,
	6.0500E-01,
	6.4500E-01,
	5.8000E-01,
	5.3300E-01,
	7.6200E-01,
	7.0615E-01,
	6.9400E-01,
	7.1700E-01,
	6.8450E-01,
	5.8700E-01,
	7.3900E-01,
	7.2361E-01,
	7.0580E-01,
	7.7500E-01,
	7.6546E-01,
	7.3513E-01,
	6.4900E-01,
	7.4050E-01,
	8.2918E-01,
	9.9835E-01,
	1.0047E+00,
	9.5681E-01,
	1.0046E+00,
	1.1098E+00,
	9.9100E-01,
	9.9277E-01,
	9.6394E-01,
	9.5557E-01,
	1.0097E+00,
	8.8979E-01,
	8.1800E-01,
	9.2529E-01,
	9.6863E-01,
	1.0544E+00,
	9.7100E-01,
	9.9570E-01,
	1.0417E+00,
	8.5416E-01,
	9.1583E-01,
	9.4269E-01,
	9.6954E-01,
	9.2472E-01,
	8.9900E-01,
	1.0122E+00,
	1.0534E+00,
	9.8383E-01,
	9.8012E-01,
	1.1346E+00,
	1.1406E+00,
	1.0250E+00,
	8.4200E-01,
	7.8916E-01,
	8.5805E-01,
	1.0890E+00,
	9.4150E-01,
	9.5800E-01,
	1.0710E+00,
	1.0716E+00,
	1.0970E+00,
	1.2860E+00,
	1.2577E+00,
	1.1570E+00,
	1.1944E+00,
	1.2934E+00,
	1.1811E+00,
	1.1444E+00,
	1.0445E+00,
	9.3442E-01,
	9.8500E-01,
	1.1240E+00,
	1.1813E+00,
	1.4144E+00,
	1.2260E+00,
	1.1520E+00,
	1.2490E+00,
	9.5426E-01,
	7.3603E-01,
	8.2100E-01,
	1.0802E+00,
	9.9113E-01,
	1.0354E+00,
	1.0067E+00,
	1.0810E+00,
	1.2519E+00,
	1.3322E+00,
	1.2400E+00,
	7.4500E-01,
	7.6675E-01,
	1.2450E+00,
	1.1626E+00,
	6.5200E-01,
	1.3010E+00,
	1.6245E+00,
	1.6885E+00,
	1.7520E+00,
	1.8140E+00,
	1.7400E+00,
	1.7630E+00,
	1.7150E+00,
	1.6660E+00,
	1.6300E+00,
	1.6990E+00,
	1.8090E+00,
	1.5370E+00,
	1.7150E+00,
	1.8160E+00,
	1.7392E+00,
	1.7144E+00,
	1.7688E+00,
	1.8150E+00,
	1.7660E+00,
	1.6850E+00,
	1.7490E+00,
	1.5990E+00,
	1.8110E+00,
	1.7820E+00,
	1.7210E+00,
	1.7080E+00,
	1.7550E+00,
	1.6990E+00,
	1.6380E+00,
	1.6510E+00,
	1.5230E+00,
	1.2120E+00,
	1.0990E+00,
	1.8220E+00,
	1.6913E+00,
	1.5600E+00,
	1.7090E+00,
	1.8680E+00,
	1.9000E+00,
	1.6630E+00,
	1.6010E+00,
	1.8300E+00,
	1.7990E+00,
	1.9220E+00,
	1.9490E+00,
	1.8941E+00,
	1.9650E+00,
	1.7557E+00,
	1.9900E+00,
	2.0140E+00,
	2.0010E+00,
	2.0690E+00,
	2.1420E+00,
	2.0470E+00,
	1.8864E+00,
	2.0180E+00,
	2.0010E+00,
	2.0630E+00,
	2.0770E+00,
	2.0320E+00,
	2.0120E+00,
	1.9973E+00,
	2.0639E+00,
	2.0780E+00,
	2.0840E+00,
	2.0150E+00,
	1.9840E+00,
	2.0210E+00,
	1.9310E+00,
	2.0120E+00,
	2.0180E+00,
	1.9390E+00,
	1.9690E+00,
	2.0700E+00,
	1.9882E+00,
	2.0120E+00,
	2.0800E+00,
	2.0120E+00,
	2.0250E+00,
	2.0860E+00,
	2.0400E+00,
	2.0680E+00,
	2.0610E+00,
	2.0623E+00,
	2.0310E+00,
	1.9890E+00,
	1.9790E+00,
	1.6010E+00,
	1.7890E+00,
	1.9350E+00,
	1.8224E+00,
	2.0320E+00,
	1.9490E+00,
	1.8560E+00,
	1.9830E+00,
	1.9339E+00,
	2.0510E+00,
	1.9490E+00,
	1.9800E+00,
	1.9240E+00,
	1.9230E+00,
	1.9160E+00,
	1.8580E+00,
	1.8600E+00,
	1.9490E+00,
	1.8330E+00,
	1.9472E+00,
	2.0250E+00,
	1.9354E+00,
	1.8800E+00,
	1.9650E+00,
	1.9100E+00,
	1.9410E+00,
	1.9890E+00,
	1.8660E+00,
	1.8240E+00,
	1.8750E+00,
	1.8910E+00,
	1.5390E+00,
	1.7590E+00,
	1.7040E+00,
	1.8600E+00,
	1.8730E+00,
	1.9150E+00,
	1.8040E+00,
	1.9410E+00,
	1.9280E+00,
	1.8740E+00,
	1.6410E+00,
	1.8800E+00,
	1.9690E+00,
	1.8920E+00,
	1.9950E+00,
	1.9580E+00,
	1.7470E+00,
	1.8690E+00,
	1.8950E+00,
	1.9740E+00,
	1.8240E+00,
	1.9130E+00,
	1.8640E+00,
	1.8000E+00,
	1.7340E+00,
	1.8880E+00,
	1.8510E+00,
	1.9190E+00,
	1.8740E+00,
	1.8609E+00,
	1.8820E+00,
	1.8260E+00,
	1.8800E+00,
	1.8630E+00,
	1.8590E+00,
	1.8960E+00,
	1.8420E+00,
	1.8780E+00,
	1.8890E+00,
	1.8570E+00,
	1.8120E+00,
	1.8530E+00,
	1.7550E+00,
	1.7860E+00,
	1.8900E+00,
	1.8010E+00,
	1.8710E+00,
	1.8360E+00,
	1.8490E+00,
	1.7500E+00,
	1.8680E+00,
	1.8590E+00,
	1.8310E+00,
	1.8280E+00,
	1.7620E+00,
	1.8720E+00,
	1.8810E+00,
	1.8730E+00,
	1.8340E+00,
	1.8180E+00,
	1.8620E+00,
	1.7990E+00,
	1.8160E+00,
	1.8340E+00,
	1.8330E+00,
	1.8520E+00,
	1.8630E+00,
	1.8540E+00,
	1.8360E+00,
	1.7920E+00,
	1.8380E+00,
	1.8210E+00,
	1.6240E+00,
	1.7218E+00,
	1.8090E+00,
	1.7880E+00,
	1.7920E+00,
	1.7890E+00,
	1.7780E+00,
	1.7960E+00,
	1.8060E+00,
	1.7720E+00,
	1.7640E+00,
	1.7700E+00,
	1.7420E+00,
	1.7150E+00,
	1.7490E+00,
	1.7790E+00,
	1.7730E+00,
	1.7580E+00,
	1.7620E+00,
	1.7510E+00,
	1.7340E+00,
	1.7240E+00,
	1.7120E+00,
	1.7360E+00,
	1.7100E+00,
	1.6550E+00,
	1.7120E+00,
	1.6640E+00,
	1.6410E+00,
	1.7020E+00,
	1.7090E+00,
	1.7110E+00,
	1.7240E+00,
	1.6784E+00,
	1.6820E+00,
	1.6670E+00,
	1.6440E+00,
	1.6400E+00,
	1.6930E+00,
	1.6930E+00,
	1.6870E+00,
	1.6650E+00,
	1.6590E+00,
	1.5901E+00,
	1.6740E+00,
	1.6370E+00,
	1.6520E+00,
	1.6093E+00,
	1.6610E+00,
	1.6650E+00,
	1.6530E+00,
	1.6130E+00,
	1.6100E+00,
	1.6090E+00,
	1.6250E+00,
	1.6140E+00,
	1.6270E+00,
	1.5910E+00,
	1.6060E+00,
	1.6020E+00,
	1.5510E+00,
	1.5260E+00,
	1.6130E+00,
	1.5910E+00,
	1.5980E+00,
	1.5750E+00,
	1.5230E+00,
	1.3233E+00,
	1.3840E+00,
	1.5390E+00,
	1.5420E+00,
	1.5580E+00,
	1.5660E+00,
	1.5710E+00,
	1.5630E+00,
	1.5540E+00,
	1.5670E+00,
	1.5550E+00,
	1.5354E+00,
	1.5348E+00,
	1.5580E+00,
	1.5340E+00,
	1.5290E+00,
	1.5060E+00,
	1.5170E+00,
	1.5130E+00,
	1.4990E+00,
	1.5150E+00,
	1.5000E+00,
	1.5070E+00,
	1.4930E+00,
	1.4940E+00,
	1.4870E+00,
	1.4930E+00,
	1.4760E+00,
	1.4660E+00,
	1.4650E+00,
	1.4330E+00,
	1.4720E+00,
	1.4760E+00,
	1.4780E+00,
	1.4790E+00,
	1.4680E+00,
	1.4540E+00,
	1.4580E+00,
	1.4570E+00,
	1.4350E+00,
	1.4420E+00,
	1.4380E+00,
	1.4170E+00,
	1.4340E+00,
	1.4220E+00,
	1.4131E+00,
	1.3987E+00,
	1.4095E+00,
	1.4187E+00,
	1.4330E+00,
	1.4138E+00,
	1.4040E+00,
	1.3990E+00,
	1.3900E+00,
	1.4040E+00,
	1.3970E+00,
	1.3818E+00,
	1.3702E+00,
	1.3819E+00,
	1.3502E+00,
	1.3694E+00,
	1.3650E+00,
	1.3570E+00,
	1.3010E+00,
	1.3487E+00,
	1.3480E+00,
	1.3600E+00,
	1.3510E+00,
	1.3607E+00,
	1.3465E+00,
	1.3429E+00,
	1.3444E+00,
	1.3370E+00,
	1.2796E+00,
	1.3357E+00,
	1.3104E+00,
	1.3333E+00,
	1.3108E+00,
	1.3390E+00,
	1.3271E+00,
	1.3100E+00,
	1.3120E+00,
	1.3000E+00,
	1.2646E+00,
	1.2830E+00,
	1.2707E+00,
	1.2649E+00,
	1.2892E+00,
	1.2955E+00,
	1.2920E+00,
	1.2892E+00,
	1.2890E+00,
	1.2808E+00,
	1.2760E+00,
	1.2740E+00,
	1.2680E+00,
	1.2720E+00,
	1.2650E+00,
	1.2809E+00,
	1.2771E+00,
	1.2610E+00,
	1.2598E+00,
	1.2680E+00,
	1.2500E+00,
	1.2590E+00,
	1.2487E+00,
	1.2460E+00,
	1.2543E+00,
	1.2566E+00,
	1.2452E+00,
	1.2000E+00,
	1.2120E+00,
	1.2310E+00,
	1.2142E+00,
	1.2146E+00,
	1.2073E+00,
	1.2120E+00,
	1.2100E+00,
	1.2090E+00,
	1.2080E+00,
	1.2102E+00,
	1.2028E+00,
	1.2014E+00,
	1.2067E+00,
	1.1930E+00,
	1.1898E+00,
	1.1950E+00,
	1.1896E+00,
	1.1810E+00,
	1.1874E+00,
	1.1890E+00,
	1.1877E+00,
	1.1800E+00,
	1.1812E+00,
	1.1704E+00,
	1.1632E+00,
	1.1500E+00,
	1.1449E+00,
	1.1260E+00,
	1.1280E+00,
	1.1427E+00,
	1.1580E+00,
	1.1501E+00,
	1.1350E+00,
	1.1248E+00,
	1.1427E+00,
	1.1422E+00,
	1.1241E+00,
	1.1342E+00,
	1.1001E+00,
	1.1309E+00,
	1.1230E+00,
	1.1162E+00,
	1.0980E+00,
	1.1100E+00,
	1.1143E+00,
	1.1160E+00,
	1.1180E+00,
	1.1174E+00,
	1.1091E+00,
	1.1050E+00,
	1.1083E+00,
	1.0861E+00,
	1.0738E+00,
	1.0740E+00,
	1.0760E+00,
	1.0560E+00,
	1.0760E+00,
	1.0715E+00,
	1.0699E+00,
	1.0759E+00,
	1.0762E+00,
	1.0749E+00,
	1.0620E+00,
	1.0563E+00,
	1.0560E+00,
	1.0550E+00,
	1.0327E+00,
	1.0459E+00,
	1.0476E+00,
	1.0597E+00,
	1.0511E+00,
	1.0549E+00,
	1.0400E+00,
	1.0500E+00,
	1.0520E+00,
	1.0287E+00,
	1.0271E+00,
	1.0140E+00,
	1.0360E+00,
	1.0370E+00,
	1.0060E+00,
	1.0110E+00,
	1.0050E+00,
	9.1000E-01,
	9.9800E-01,
	9.9000E-01,
	9.8100E-01,
	8.6900E-01,
	9.2700E-01,
	9.9017E-01,
	1.0056E+00,
	1.0070E+00,
	1.0050E+00,
	1.0000E+00,
	9.9900E-01,
	1.0060E+00,
	1.0120E+00,
	9.9006E-01,
	9.7354E-01,
	8.5800E-01,
	9.2500E-01,
	9.6900E-01,
	9.5900E-01,
	9.7700E-01,
	9.6317E-01,
	9.7600E-01,
	9.6614E-01,
	9.4913E-01,
	9.3562E-01,
	9.6200E-01,
	9.6500E-01,
	9.6200E-01,
	9.4571E-01,
	9.4856E-01,
	9.1963E-01,
	9.4408E-01,
	9.3930E-01,
	9.4352E-01,
	9.5469E-01,
	9.2558E-01,
	9.2300E-01,
	9.4066E-01,
	9.4367E-01,
	9.4236E-01,
	9.3928E-01,
	9.3259E-01,
	9.1800E-01,
	9.2400E-01,
	9.2600E-01,
	9.3425E-01,
	9.2686E-01,
	9.2378E-01,
	9.1396E-01,
	9.1378E-01,
	8.9834E-01,
	8.7720E-01,
	9.2233E-01,
	9.2100E-01,
	9.1800E-01,
	9.0780E-01,
	9.1450E-01,
	9.0143E-01,
	8.8552E-01,
	8.9496E-01,
	8.9730E-01,
	8.9016E-01,
	9.0020E-01,
	8.9820E-01,
	8.8830E-01,
	8.9470E-01,
	8.8860E-01,
	8.8810E-01,
	8.9210E-01,
	8.8540E-01,
	8.7030E-01,
	8.6280E-01,
	8.3335E-01,
	8.6957E-01,
	8.7642E-01,
	8.4561E-01,
	8.7809E-01,
	8.7110E-01,
	8.6954E-01,
	8.6866E-01,
	8.7078E-01,
	8.6514E-01,
	8.6958E-01,
	8.6709E-01,
	8.5601E-01,
	8.5222E-01,
	8.5368E-01,
	8.5936E-01,
	8.5676E-01,
	8.4000E-01,
	8.3153E-01,
	8.0616E-01,
	8.3814E-01,
	8.1854E-01,
	8.2441E-01,
	8.3138E-01,
	8.2809E-01,
	8.3137E-01,
	8.3303E-01,
	8.2867E-01,
	8.2019E-01,
	8.2402E-01,
	8.2050E-01,
	8.1200E-01,
	7.6900E-01,
	8.0200E-01,
	8.0583E-01,
	8.1147E-01,
	8.1483E-01,
	8.0627E-01,
	7.9982E-01,
	8.0173E-01,
	7.9761E-01,
	7.8808E-01,
	7.9579E-01,
	7.8598E-01,
	7.9503E-01,
	7.8526E-01,
	7.8789E-01,
	7.9140E-01,
	7.8186E-01,
	7.8785E-01,
	7.8149E-01,
	7.6882E-01,
	7.7348E-01,
	7.8054E-01,
	7.7208E-01,
	7.7800E-01,
	7.6650E-01,
	7.7512E-01,
	7.7300E-01,
	7.7879E-01,
	7.7541E-01,
	7.6881E-01,
	7.7081E-01,
	7.6620E-01,
	7.6606E-01,
	7.6368E-01,
	7.5500E-01,
	7.5694E-01,
	7.6161E-01,
	7.5714E-01,
	7.5639E-01,
	7.5851E-01,
	7.5392E-01,
	7.5347E-01,
	7.4300E-01,
	7.4300E-01,
	7.4200E-01,
	7.4255E-01,
};

double atmo_spectralIrradiance_get(double lambda)
{
    int index = (int)lambda - 280;
    if (index < 0 || index >= 721)
    {
        // TODO: error?
        return 0.0;
    }
    return kSpectralIrradianceTable[index];
}
